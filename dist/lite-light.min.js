const c = {};
let v = 0, p = 0;
function d(e) {
  return c[e] || (c[e] = new Image(), c[e].src = e), c[e];
}
function L() {
  const e = window.scrollY;
  document.body.style.position = "fixed", document.body.style.top = `-${e}px`, document.body.style.width = "100%", document.body.style.overflowY = "scroll";
}
function x() {
  const e = document.body.style.top;
  document.body.style.position = "", document.body.style.top = "", document.body.style.width = "", document.body.style.overflowY = "", window.scrollTo(0, parseInt(e || "0") * -1);
}
function A(e = {}) {
  const i = {
    imageSelector: e.imageSelector || "img[data-lightbox]",
    imageUrlAttribute: e.imageUrlAttribute || "data-lightbox",
    lightboxClass: e.lightboxClass || "lite-light",
    swipeThreshold: e.swipeThreshold || 50,
    fadeAnimationDuration: e.fadeAnimationDuration || 150,
    ...e
  };
  document.querySelector(`.${i.lightboxClass}`) || w(i.lightboxClass), document.addEventListener("click", (g) => {
    if (g.target.tagName !== "IMG" || !g.target.hasAttribute(i.imageUrlAttribute)) return;
    const l = Array.from(document.querySelectorAll(i.imageSelector));
    let n = l.findIndex((t) => t === g.target);
    const a = document.querySelector(`.${i.lightboxClass}`), o = a.querySelector("img");
    function b(t) {
      const s = (t - 1 + l.length) % l.length, m = (t + 1) % l.length;
      d(l[s].getAttribute(i.imageUrlAttribute)), d(l[m].getAttribute(i.imageUrlAttribute));
    }
    function r(t) {
      n = (t + l.length) % l.length;
      const s = l[n].getAttribute(i.imageUrlAttribute);
      d(s), o.classList.add("lite-light-fade-out"), o.addEventListener("animationend", function m() {
        o.src = s, o.classList.remove("lite-light-fade-out"), o.classList.add("lite-light-fade-in"), b(n), o.addEventListener("animationend", function() {
          o.classList.remove("lite-light-fade-in");
        }, { once: !0 }), o.removeEventListener("animationend", m);
      }, { once: !0 });
    }
    function f(t) {
      v = t.changedTouches[0].screenX;
    }
    function y(t) {
      p = t.changedTouches[0].screenX;
      const s = p - v;
      Math.abs(s) > i.swipeThreshold && (r(s > 0 ? n - 1 : n + 1), t.stopPropagation());
    }
    function u(t) {
      t.key === "ArrowLeft" ? (r(n - 1), t.preventDefault()) : t.key === "ArrowRight" ? (r(n + 1), t.preventDefault()) : t.key === "Escape" && (h(), t.preventDefault());
    }
    a.style.display = "flex", d(l[n].getAttribute(i.imageUrlAttribute)), b(n), o.src = l[n].getAttribute(i.imageUrlAttribute), o.classList.add("lite-light-fade-in"), L(), o.addEventListener("animationend", () => {
      o.classList.remove("lite-light-fade-in");
    }, { once: !0 }), a.removeEventListener("touchstart", f), a.removeEventListener("touchend", y), a.addEventListener("touchstart", f), a.addEventListener("touchend", y), document.removeEventListener("keydown", u), document.addEventListener("keydown", u), a.querySelector(".lite-light-prev").onclick = (t) => {
      t.stopPropagation(), r(n - 1);
    }, a.querySelector(".lite-light-next").onclick = (t) => {
      t.stopPropagation(), r(n + 1);
    };
    function h() {
      a.style.display = "none", x(), document.removeEventListener("keydown", u);
    }
    a.querySelector(".lite-light-close").onclick = (t) => {
      t.stopPropagation(), h();
    }, a.onclick = () => {
      h();
    };
  });
}
function w(e) {
  const i = `
    <div class="${e}">
      <div class="lite-light-prev lite-light-button">
        <span class="lite-light-arrow lite-light-left"></span>
      </div>
      <img style="max-width: 90%; max-height: 90%;" />
      <div class="lite-light-next lite-light-button">
        <span class="lite-light-arrow lite-light-right"></span>
      </div>
      <div class="lite-light-close lite-light-button">
        <span class="lite-light-bar"></span>
        <span class="lite-light-bar"></span>
      </div>
    </div>
  `;
  document.body.insertAdjacentHTML("beforeend", i);
}
function E(e) {
  A(e);
}
export {
  E as init,
  A as initLiteLight
};
